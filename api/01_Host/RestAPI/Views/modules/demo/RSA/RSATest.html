<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>
    <script src="jquery-1.4.1.min.js" type="text/javascript"></script>
    <script src="BigInt.js" type="text/javascript"></script>
    <script src="RSA.js" type="text/javascript"></script>
    <script src="Barrett.js" type="text/javascript"></script>
    <script type="text/javascript">

        $(function () {
            var host = "http://localhost:3760/";
            var token = $('#txt_Token').val();

            $('#btn_Init_RSA').click(function () {

                $.get(host + "Demo", { token: token }, function (reply) {
                    var result = reply.Data;
                    window.localStorage["PublicKeyModulus"] = result.PublicKeyModulus;
                    window.localStorage["PublicKeyExponent"] = result.PublicKeyExponent;
                }, "json");

            });

            $('#btn_Encrypted').click(function () {
                setMaxDigits(129);
                var key = new RSAKeyPair(window.localStorage["PublicKeyExponent"], "", window.localStorage["PublicKeyModulus"]);
                var temp = encryptedString(key, $('#txt_Input').val());
                $("#txt_Encrypted").val(temp);

            });

            $('#btn_Decrypt').click(function () {

                var v = $("#txt_Encrypted").val();
                $.post(host + "Demo", { value: v, token: token }, function (reply) {
                    var result = reply.Data;
                    $('#txt_Output').val(result);
                }, "json");



            });

        });

    </script>
</head>
<body>
    //初始化生成公钥和私钥 公钥发回到客户端 私钥存储在服务端
    <p>
        <input id="txt_Token" type="text" value="default" />
        <input id="btn_Init_RSA" type="button" value="INIT RSA" />
    </p>

    //输入的内容
    <p>
        <input id="txt_Input" type="text" />
    </p>

    //客户端加密后的内容
    <p>
        <input id="btn_Encrypted" type="button" value="ENCRYPTED" />
        <input id="txt_Encrypted" type="text" />
    </p>

    //服务端解密返回的内容
    <p>
        <input id="btn_Decrypt" type="button" value="DECRYPT" />
        <input id="txt_Output" type="text" />
    </p>

</body>
</html>
